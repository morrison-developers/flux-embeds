generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Board {
  id            String          @id
  name          String
  defaultGameId String?
  topTeamLabel  String
  sideTeamLabel String
  columnMarkers Json
  rowMarkers    Json
  assignments   Json
  themeDefaults Json
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  owners        BoardOwner[]
  quarterWinners QuarterWinner[]
}

model BoardOwner {
  id          String          @id @default(cuid())
  boardId     String
  initials    String
  displayName String
  bgColor     String
  textColor   String
  sortOrder   Int
  lockedAt    DateTime?
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  board       Board           @relation(fields: [boardId], references: [id], onDelete: Cascade)
  quarterWins QuarterWinner[]

  @@unique([boardId, initials])
  @@index([boardId, sortOrder])
}

model QuarterWinner {
  id                 String     @id @default(cuid())
  boardId            String
  quarter            Int
  ownerId            String?
  homeScore          Int
  awayScore          Int
  gamePeriodRecorded Int
  createdAt          DateTime   @default(now())
  updatedAt          DateTime   @updatedAt
  board              Board      @relation(fields: [boardId], references: [id], onDelete: Cascade)
  owner              BoardOwner? @relation(fields: [ownerId], references: [id], onDelete: SetNull)

  @@unique([boardId, quarter])
  @@index([boardId])
}
